"use strict";(self.webpackChunkkaito_website=self.webpackChunkkaito_website||[]).push([[1631],{1018:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/phi-4-mini-ttft-634b634c0a1ac5b17bdfa73c5672765e.png"},1667:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/phi-4-mini-itl-60edef73d48b708a71da51d84ec263f6.png"},3150:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/llama-3.1-8b-itl-c171e4e2b73e195b776c948a3ecb6c35.png"},4747:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/a10-itl-1b977f788d00d992c70691b67b898961.png"},6566:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"gpu-benchmarks","title":"GPU Benchmarks","description":"These benchmarks help users choose the optimal GPU SKU for running their AI models with KAITO. We compare performance characteristics across different GPU types to guide cost-effective hardware selection.","source":"@site/docs/gpu-benchmarks.md","sourceDirName":".","slug":"/gpu-benchmarks","permalink":"/kaito/docs/next/gpu-benchmarks","draft":false,"unlisted":false,"editUrl":"https://github.com/kaito-project/kaito/tree/main/website/docs/gpu-benchmarks.md","tags":[],"version":"current","frontMatter":{"title":"GPU Benchmarks"},"sidebar":"sidebar","previous":{"title":"Bring Your Own GPU Nodes","permalink":"/kaito/docs/next/kaito-on-byo-gpu-nodes"},"next":{"title":"Contributing","permalink":"/kaito/docs/next/contributing"}}');var t=i(4848),r=i(8453);const o={title:"GPU Benchmarks"},l=void 0,a={},c=[{value:"Test Setup",id:"test-setup",level:2},{value:"Infrastructure Configuration",id:"infrastructure-configuration",level:3},{value:"GPU Selection Rationale",id:"gpu-selection-rationale",level:3},{value:"Benchmark Framework",id:"benchmark-framework",level:3},{value:"Model Configurations",id:"model-configurations",level:3},{value:"Phi-4 Mini Instruct Model",id:"phi-4-mini-instruct-model",level:4},{value:"Llama 3.1 8B Instruct Model",id:"llama-31-8b-instruct-model",level:4},{value:"A10 GPU",id:"a10-gpu",level:4},{value:"Testing Methodology",id:"testing-methodology",level:3},{value:"Benchmark Results",id:"benchmark-results",level:2},{value:"A10 GPU results",id:"a10-gpu-results",level:3},{value:"Time to First Token",id:"time-to-first-token",level:4},{value:"Inter-token Latency",id:"inter-token-latency",level:4},{value:"Phi 4 Mini Comparison",id:"phi-4-mini-comparison",level:3},{value:"Time to First Token",id:"time-to-first-token-1",level:4},{value:"Inter-token Latency",id:"inter-token-latency-1",level:4},{value:"Llama 3.1 8B comparison",id:"llama-31-8b-comparison",level:3},{value:"Time to First Token",id:"time-to-first-token-2",level:4},{value:"Inter-Token Latency",id:"inter-token-latency-2",level:4},{value:"Performance Analysis",id:"performance-analysis",level:2},{value:"A10 GPU Performance",id:"a10-gpu-performance",level:3},{value:"A100 vs H100 Comparison",id:"a100-vs-h100-comparison",level:3},{value:"Phi 4 Mini Performance",id:"phi-4-mini-performance",level:4},{value:"Llama 3.1 8B Performance",id:"llama-31-8b-performance",level:4},{value:"Recommendations",id:"recommendations",level:2},{value:"Cost-Performance Optimization",id:"cost-performance-optimization",level:3},{value:"Workload-Specific Guidance",id:"workload-specific-guidance",level:3},{value:"Scaling Considerations",id:"scaling-considerations",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"These benchmarks help users choose the optimal GPU SKU for running their AI models with KAITO. We compare performance characteristics across different GPU types to guide cost-effective hardware selection."}),"\n",(0,t.jsx)(n.h2,{id:"test-setup",children:"Test Setup"}),"\n",(0,t.jsx)(n.h3,{id:"infrastructure-configuration",children:"Infrastructure Configuration"}),"\n",(0,t.jsx)(n.p,{children:"We established a dedicated Kubernetes cluster with KAITO deployed to conduct comprehensive GPU performance benchmarks. The testing infrastructure was configured to evaluate three distinct GPU types: NVIDIA A10, A100, and H100, each representing different performance tiers and cost points in the GPU ecosystem."}),"\n",(0,t.jsx)(n.h3,{id:"gpu-selection-rationale",children:"GPU Selection Rationale"}),"\n",(0,t.jsxs)(n.p,{children:["Due to memory and compute constraints, the A10 GPU was evaluated separately using lighter model configurations, as it lacks sufficient resources to handle the larger workloads tested on the A100 and H100 GPUs. The primary comparison focused on A100 and H100 performance characteristics using two representative models: ",(0,t.jsx)(n.code,{children:"phi-4-mini-instruct"})," and ",(0,t.jsx)(n.code,{children:"llama-3.1-8b-instruct"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"benchmark-framework",children:"Benchmark Framework"}),"\n",(0,t.jsxs)(n.p,{children:["All performance tests utilized ",(0,t.jsx)(n.a,{href:"https://github.com/vllm-project/vllm",children:"vLLM"})," by running the official ",(0,t.jsx)(n.code,{children:"benchmark_serving.py"})," ",(0,t.jsx)(n.a,{href:"https://github.com/vllm-project/vllm/blob/main/benchmarks/benchmark_serving.py",children:"script"}),", which provides standardized metrics for evaluating inference server performance. This tool measures critical performance indicators including:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Time to First Token (TTFT)"}),": How long the user must wait until the model begins to deliver a response."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Inter-Token Latency (ITL)"}),": How fast the model generates subsequent tokens after it begins its response."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"model-configurations",children:"Model Configurations"}),"\n",(0,t.jsxs)(n.p,{children:["We tested the models ",(0,t.jsx)(n.a,{href:"https://huggingface.co/microsoft/Phi-4-mini-instruct",children:"Phi-4-mini-instruct"})," and ",(0,t.jsx)(n.a,{href:"https://huggingface.co/meta-llama/Llama-3.1-8B-Instruct",children:"Llama-3.1-8B-Instruct"}),". The following fields were configured:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Requests Per Second (RPS)"}),": Total throughput capacity with latency in powers of two, such as 1, 2, 4, etc. up to 64 for larger GPUs, indicated by the ",(0,t.jsx)(n.code,{children:"--request-rate"})," flag."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Max Concurrency"}),": The maximum number of simultaneous requests the server can handle, configured with the ",(0,t.jsx)(n.code,{children:"--max-concurrency"})," flag. It was set to 200 for the A10 and H100 tests and 50 for the A10 tests. These values were selected in order to set a ceiling high enough that it will not bottleneck the GPU."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Random Input Length"}),": The length of the input prompts, configured with the ",(0,t.jsx)(n.code,{children:"--random-input-len"})," flag. This value was increased for larger models/GPUs that could handle an increased workload. A smaller value could represent a conversation workload, while a larger value could represent a document or source code."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Random Output Length"}),": The length of the expected output responses, configured with the ",(0,t.jsx)(n.code,{children:"--random-output-len"})," flag."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Number of prompts"}),": We configured each test to run for 60 seconds, so with the number of prompts was set to ",(0,t.jsx)(n.code,{children:"$RATE * 60"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"phi-4-mini-instruct-model",children:"Phi-4 Mini Instruct Model"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"microsoft/Phi-4-mini-instruct"})," model was tested with the following configuration with"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'python benchmark_serving.py \\\n    --backend vllm \\\n    --model microsoft/Phi-4-mini-instruct \\\n    --served-model-name phi-4-mini-instruct \\\n    --base-url http://localhost:8000 \\\n    --endpoint /v1/completions \\\n    --num-prompts $NUM_PROMPTS \\\n    --request-rate $RATE \\\n    --max-concurrency 200 \\\n    --random-input-len 200 \\\n    --random-output-len 200 \\\n    --dataset-name random \\\n    --ignore-eos \\\n    --save-result \\\n    --result-dir "./out/$GPU"\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Input Token Length"}),": 200 tokens (simulating medium-length user queries)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Output Token Length"}),": 200 tokens (representing typical conversational responses)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use Case"}),": Optimized for interactive chat applications and content generation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Load Pattern"}),": Variable request rates from 1 to 64 QPS"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"llama-31-8b-instruct-model",children:"Llama 3.1 8B Instruct Model"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"meta-llama/Llama-3.1-8B-Instruct"})," model was configured for high-throughput, short-response scenarios:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'python benchmark_serving.py \\\n    --backend vllm \\\n    --model meta-llama/Llama-3.1-8B-Instruct \\\n    --served-model-name llama-3.1-8b-instruct \\\n    --base-url http://localhost:8000 \\\n    --endpoint /v1/completions \\\n    --num-prompts $NUM_PROMPTS \\\n    --request-rate $RATE \\\n    --max-concurrency 200 \\\n    --random-input-len 1000 \\\n    --random-output-len 200 \\\n    --dataset-name random \\\n    --ignore-eos \\\n    --save-result \\\n    --result-dir "./out/$GPU"\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Test Parameters:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Input Token Length"}),": 1000 tokens"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Output Token Length"}),": 200 tokens"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use Case"}),": Optimized for large context understanding with minimal output generation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Load Pattern"}),": Variable request rates from 1 to 64 QPS"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"a10-gpu",children:"A10 GPU"}),"\n",(0,t.jsx)(n.p,{children:"Since the A10 GPU was not powerful enough to run larger models, higher input/output lengths, or higher QPS, we tested it individually with lower settings as to not skew the results of the other GPUs."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The QPS ranged in powers of two from 1 to 16 instead of 64."}),"\n",(0,t.jsx)(n.li,{children:"For Phi 4 Mini and Llama 3.1 8B, the max concurrency was set to 50 instead of 200."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"testing-methodology",children:"Testing Methodology"}),"\n",(0,t.jsx)(n.h2,{id:"benchmark-results",children:"Benchmark Results"}),"\n",(0,t.jsx)(n.h3,{id:"a10-gpu-results",children:"A10 GPU results"}),"\n",(0,t.jsx)(n.h4,{id:"time-to-first-token",children:"Time to First Token"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(9922).A+"",width:"1983",height:"1323"})}),"\n",(0,t.jsx)(n.h4,{id:"inter-token-latency",children:"Inter-token Latency"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(4747).A+"",width:"1983",height:"1322"})}),"\n",(0,t.jsx)(n.h3,{id:"phi-4-mini-comparison",children:"Phi 4 Mini Comparison"}),"\n",(0,t.jsx)(n.h4,{id:"time-to-first-token-1",children:"Time to First Token"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(1018).A+"",width:"1983",height:"1323"})}),"\n",(0,t.jsx)(n.h4,{id:"inter-token-latency-1",children:"Inter-token Latency"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(1667).A+"",width:"1982",height:"1323"})}),"\n",(0,t.jsx)(n.h3,{id:"llama-31-8b-comparison",children:"Llama 3.1 8B comparison"}),"\n",(0,t.jsx)(n.h4,{id:"time-to-first-token-2",children:"Time to First Token"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(6649).A+"",width:"1982",height:"1323"})}),"\n",(0,t.jsx)(n.h4,{id:"inter-token-latency-2",children:"Inter-Token Latency"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(3150).A+"",width:"1982",height:"1323"})}),"\n",(0,t.jsx)(n.h2,{id:"performance-analysis",children:"Performance Analysis"}),"\n",(0,t.jsx)(n.h3,{id:"a10-gpu-performance",children:"A10 GPU Performance"}),"\n",(0,t.jsx)(n.p,{children:"The A10 GPU performas well on Phi 4 Mini but is not suited for larger models such as Llama 3.1 8B."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Phi 4 Mini on A10:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"TTFT remains stable and fast from (19-35ms)"}),"\n",(0,t.jsx)(n.li,{children:"ITL is consistent and low (4.78-6.07ms) but begins to grow as request rates increase."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Llama 3.1 8B on A10:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Shows dramatically higher TTFT (671-20,344) and would result in a considerable wait time."}),"\n",(0,t.jsx)(n.li,{children:"ITL grows but remains consistently fast despite the extremely long TTFT."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"a100-vs-h100-comparison",children:"A100 vs H100 Comparison"}),"\n",(0,t.jsx)(n.h4,{id:"phi-4-mini-performance",children:"Phi 4 Mini Performance"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The H100 almost always has a consistent TTFT of around 600-700 ms, which is surprisingly higher than that of the A100. This is likely because the H100 is meant for larger workloads and a smaller model like this is not optimized to take advantage of its bandwidth."}),"\n",(0,t.jsx)(n.li,{children:"The ITL of the H100 is, however, is also consistently lower across all load levels than the A100, which is as expected based as the H100 is a more powerful GPU."}),"\n",(0,t.jsx)(n.li,{children:"In terms of scaling, the H100 maintains stable performance up to 32 QPS, then shows degradation at 64 QPS, and the A100 shows more gradual degradation but reaches saturation earlier."}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"llama-31-8b-performance",children:"Llama 3.1 8B Performance"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Both GPUs show very similar performance characteristics for this model as TTFT and ITL metrics are very close between the two GPUs."}),"\n",(0,t.jsx)(n.li,{children:"Both GPUs handle up to 8 QPS with excellent performance and significant performance jump occurs at 16 QPS, which likely reaches a threshold where batching optimizations kick in."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"recommendations",children:"Recommendations"}),"\n",(0,t.jsx)(n.h3,{id:"cost-performance-optimization",children:"Cost-Performance Optimization"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"For Phi 4 Mini workloads:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"H100"}),": Recommended for high-throughput production environments requiring low latency"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"A100"}),": Cost-effective option for moderate workloads where slight latency increases are acceptable"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"A10"}),": Suitable for development, testing, or low-volume production use cases"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"For Llama 3.1 8B workloads:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"A100 and H100"}),": Performance parity makes the A100 the more cost-effective choice"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"A10"}),": Can handle the model but limited to short output scenarios"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"workload-specific-guidance",children:"Workload-Specific Guidance"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"High-Throughput Scenarios (>32 QPS):"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"H100 for Phi 4 Mini due to superior scaling characteristics"}),"\n",(0,t.jsx)(n.li,{children:"Either A100 or H100 for Llama 3.1 8B, with A100 offering better cost efficiency"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Latency-Sensitive Applications:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"H100 provides consistently lower TTFT and ITL for Phi 4 Mini"}),"\n",(0,t.jsx)(n.li,{children:"A100 and H100 perform similarly for Llama 3.1 8B"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Budget-Conscious Deployments:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"A10 for light workloads and development"}),"\n",(0,t.jsx)(n.li,{children:"A100 for production workloads where H100 performance gains don't justify the cost premium"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"scaling-considerations",children:"Scaling Considerations"}),"\n",(0,t.jsx)(n.p,{children:"The benchmark results suggest optimal operating ranges:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Low-load optimal"}),": 1-8 QPS for consistent, predictable performance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"High-throughput optimal"}),": 16-32 QPS where batching optimizations provide maximum efficiency"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Saturation point"}),": Beyond 32-64 QPS, performance gains diminish and latency increases"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"KAITO is currently adding a feature to distribute the load across model servers when QPS is high to mitigate these issues."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"We are currently working on adding automatic scaling across model servers when QPS is high."})}),"\n",(0,t.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsx)(n.p,{children:"These benchmarks demonstrate that GPU selection should be based on specific workload requirements and cost considerations. While the H100 shows superior performance for certain models like Phi 4 Mini, the A100 provides excellent value for models like Llama 3.1 8B where performance parity exists. The A10 serves as an entry-level option for development and light production workloads."}),"\n",(0,t.jsx)(n.p,{children:"For optimal cost-performance in production environments, we recommend starting with A100 GPUs and scaling to H100 only when the specific performance requirements and throughput demands justify the additional cost."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},6649:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/llama-3.1-8b-ttft-1e607c3bff9f417f70f7ceb65bc096ac.png"},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}},9922:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/a10-ttft-6a0f08628202149cbbc5d4c0f64587f6.png"}}]);