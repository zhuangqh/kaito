"use strict";(self.webpackChunkkaito_website=self.webpackChunkkaito_website||[]).push([[108],{2920:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var i=t(4848),s=t(8453);const a={},d="Retrieval-Augmented Generation (RAG)",r={id:"rag",title:"Retrieval-Augmented Generation (RAG)",description:"This document presents how to use the KAITO ragengine Custom Resource Definition (CRD) for retrieval-augumented generatoin workflow. By creating a RAGEngine resource, you can quickly stand up a service that indexes documents and queries them in conjunction with an existing LLM inference endpoint\u2014no need to custom-build pipelines. This enables your large language model to answer questions based on your own private content.",source:"@site/docs/rag.md",sourceDirName:".",slug:"/rag",permalink:"/kaito/docs/rag",draft:!1,unlisted:!1,editUrl:"https://github.com/kaito-project/kaito/tree/main/website/docs/rag.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Fine Tuning",permalink:"/kaito/docs/tuning"},next:{title:"Custom Model Integration",permalink:"/kaito/docs/custom-model"}},o={},l=[{value:"Installation",id:"installation",level:2},{value:"Verify installation",id:"verify-installation",level:2},{value:"Clean up",id:"clean-up",level:2},{value:"Usage",id:"usage",level:2},{value:"Prerequisite",id:"prerequisite",level:3},{value:"Define the RAGEngine",id:"define-the-ragengine",level:3},{value:"Apply the Manifest",id:"apply-the-manifest",level:3},{value:"Relationship Between Index, Documents, and Document Nodes",id:"relationship-between-index-documents-and-document-nodes",level:3},{value:"Creating an Index With Documents",id:"creating-an-index-with-documents",level:3},{value:"Splitting Documents with CodeSplitter",id:"splitting-documents-with-codesplitter",level:4},{value:"List Documents",id:"list-documents",level:3},{value:"Updating Documents",id:"updating-documents",level:3},{value:"Delete Documents",id:"delete-documents",level:3},{value:"Persist Index",id:"persist-index",level:3},{value:"Load Index",id:"load-index",level:3},{value:"Delete Index",id:"delete-index",level:3},{value:"Query Index",id:"query-index",level:3},{value:"Example Client",id:"example-client",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"retrieval-augmented-generation-rag",children:"Retrieval-Augmented Generation (RAG)"}),"\n",(0,i.jsxs)(n.p,{children:["This document presents how to use the KAITO ",(0,i.jsx)(n.code,{children:"ragengine"})," Custom Resource Definition (CRD) for retrieval-augumented generatoin workflow. By creating a RAGEngine resource, you can quickly stand up a service that indexes documents and queries them in conjunction with an existing LLM inference endpoint\u2014no need to custom-build pipelines. This enables your large language model to answer questions based on your own private content."]}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Be sure you've cloned this repo and followed ",(0,i.jsx)(n.a,{href:"/kaito/docs/installation",children:"kaito workspace installation"})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm install ragengine ./charts/kaito/ragengine --namespace kaito-ragengine --create-namespace\n"})}),"\n",(0,i.jsx)(n.h2,{id:"verify-installation",children:"Verify installation"}),"\n",(0,i.jsx)(n.p,{children:"You can run the following commands to verify the installation of the controllers were successful."}),"\n",(0,i.jsx)(n.p,{children:"Check status of the Helm chart installations."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm list -n kaito-ragengine\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Check status of the ",(0,i.jsx)(n.code,{children:"ragengine"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl describe deploy ragengine -n kaito-ragengine\n"})}),"\n",(0,i.jsx)(n.h2,{id:"clean-up",children:"Clean up"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm uninstall kaito-ragengine\n"})}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.h3,{id:"prerequisite",children:"Prerequisite"}),"\n",(0,i.jsx)(n.p,{children:"Before creating a RAGEngine, ensure you have an accessible model inference endpoint. This endpoint can be:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"A model deployed through KAITO Workspace CRD (e.g., a local Hugging Face model, a vLLM instance, etc.)."}),"\n",(0,i.jsx)(n.li,{children:"An external API (e.g., Huggingface service or other REST-based LLM providers)."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"define-the-ragengine",children:"Define the RAGEngine"}),"\n",(0,i.jsx)(n.p,{children:"Create a YAML manifest defining your RAGEngine. Key fields under spec include:"}),"\n",(0,i.jsx)(n.p,{children:"Embedding: how to generate vector embeddings for your documents. You may choose remote or local (one must be left unset if you pick the other):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'embedding:\n    local:\n      modelID: "BAAI/bge-small-en-v1.5"\n'})}),"\n",(0,i.jsx)(n.p,{children:"InferenceService: points to the LLM endpoint that RAGEngine will call for final text generation."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'inferenceService:\n  url: "<inference-url>/v1/completions"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Users also need to specify the GPU SKU used for inference in the ",(0,i.jsx)(n.code,{children:"compute"})," spec. For example,"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: kaito.sh/v1alpha1\nkind: RAGEngine\nmetadata:\n  name: ragengine-start\nspec:\n  compute:\n    instanceType: "Standard_NC6s_v3"\n    labelSelector:\n      matchLabels:\n        apps: ragengine-example\n  embedding:\n    local:\n      modelID: "BAAI/bge-small-en-v1.5"\n  inferenceService:\n    url: "<inference-url>/v1/completions"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"apply-the-manifest",children:"Apply the Manifest"}),"\n",(0,i.jsx)(n.p,{children:"After you create your YAML configuration, run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"kubectl apply -f examples/RAG/kaito_ragengine_phi_3.yaml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"relationship-between-index-documents-and-document-nodes",children:"Relationship Between Index, Documents, and Document Nodes"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"RAGEngine index"})," is a logical collection that organizes and stores your documents for retrieval-augmented generation workflows. The relationship between indexes, documents, and document nodes is as follows:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Index"}),": An index is a named container that holds a set of documents. Each index is independent and can be created, updated, queried, persisted, loaded, or deleted via the API."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Documents"}),": Documents are the primary units of content that you add to an index. Each document contains a ",(0,i.jsx)(n.code,{children:"text"})," field (the content to be indexed) and optional ",(0,i.jsx)(n.code,{children:"metadata"})," (such as author, source, or custom tags). When you add documents to an index, each is assigned a unique ",(0,i.jsx)(n.code,{children:"doc_id"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Document Nodes"}),": When a document is ingested, it is automatically split into smaller chunks called ",(0,i.jsx)(n.em,{children:"nodes"}),". The splitting strategy depends on the document type and metadata:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"By default, documents are split into sentences."}),"\n",(0,i.jsxs)(n.li,{children:["If you specify code-aware splitting (using the ",(0,i.jsx)(n.code,{children:"split_type"})," and ",(0,i.jsx)(n.code,{children:"language"})," metadata), the document is split into code blocks or logical code units."]}),"\n",(0,i.jsx)(n.li,{children:"Each node represents a chunk of text that is indexed and can be retrieved as part of a query."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"How it works in practice:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"When you index a document, it is divided into nodes for efficient retrieval and semantic search."}),"\n",(0,i.jsx)(n.li,{children:"When you query an index, the engine retrieves the most relevant nodes (not necessarily whole documents) and can use them to generate answers or summaries."}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"source_nodes"})," field in query responses contains the actual nodes that matched your query, along with their scores and metadata."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This design enables fine-grained retrieval and more accurate, context-aware responses from your LLM-powered applications."}),"\n",(0,i.jsx)(n.h3,{id:"creating-an-index-with-documents",children:"Creating an Index With Documents"}),"\n",(0,i.jsxs)(n.p,{children:["To add documents to an index or create a new index, use the ",(0,i.jsx)(n.code,{children:"/index"})," API route. This endpoint accepts a POST request with the index name and a list of documents to be indexed."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'POST /index\n{\n  "index_name": "rag_index",\n  "documents": [\n    {\n      "text": "Retrieval Augmented Generation (RAG) is an architecture that augments the capabilities of a Large Language Model (LLM) like ChatGPT by adding an information retrieval system that provides grounding data.",\n      "metadata": {\n        "author": "Microsoft",\n        "source": "https://learn.microsoft.com/en-us/azure/search/retrieval-augmented-generation-overview?tabs=docs"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"index_name"}),": The name of the index to create or update."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"documents"}),": A list of documents, each with a ",(0,i.jsx)(n.code,{children:"text"})," field and optional ",(0,i.jsx)(n.code,{children:"metadata"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "doc_id": "123456",\n    "text": "Retrieval Augmented Generation (RAG) is an architecture that augments the capabilities of a Large Language Model (LLM) like ChatGPT by adding an information retrieval system that provides grounding data.",\n    "hash_value": "text_hash_value",\n    "metadata": {\n      "author": "Microsoft",\n      "source": "https://learn.microsoft.com/en-us/azure/search/retrieval-augmented-generation-overview?tabs=docs"\n    },\n    "is_truncated": false\n  }\n]\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Each returned document includes its unique ",(0,i.jsx)(n.code,{children:"doc_id"}),", the original text, metadata, and a flag indicating if the text was truncated. The ",(0,i.jsx)(n.code,{children:"doc_id"})," will be important for document update/delete calls."]}),"\n",(0,i.jsx)(n.h4,{id:"splitting-documents-with-codesplitter",children:"Splitting Documents with CodeSplitter"}),"\n",(0,i.jsxs)(n.p,{children:["By default, RAGEngine splits documents into sentences. However, you can instruct the engine to split documents using the ",(0,i.jsx)(n.code,{children:"CodeSplitter"})," (for code-aware chunking) by providing metadata in your API request."]}),"\n",(0,i.jsxs)(n.p,{children:["To use the ",(0,i.jsx)(n.code,{children:"CodeSplitter"}),", set the ",(0,i.jsx)(n.code,{children:"split_type"})," to ",(0,i.jsx)(n.code,{children:'"code"'})," and specify the programming language in the ",(0,i.jsx)(n.code,{children:"language"})," field of the document metadata. For example, when calling the RAGEngine API to index documents:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "documents": [\n    {\n      "text": "def foo():\\n    return 42\\n\\n# Another function\\ndef bar():\\n    pass",\n      "metadata": {\n        "split_type": "code",\n        "language": "python"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This instructs the RAGEngine to use code-aware splitting for the provided document. If ",(0,i.jsx)(n.code,{children:"split_type"})," is not set or set to any other value, sentence splitting will be used by default."]}),"\n",(0,i.jsx)(n.h3,{id:"list-documents",children:"List Documents"}),"\n",(0,i.jsxs)(n.p,{children:["To retrieve a paginated list of documents from a specific index, use the ",(0,i.jsx)(n.code,{children:"/indexes/{index_name}/documents"})," API route. This endpoint accepts a GET request with optional query parameters for pagination, text truncation, and metadata filtering."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"GET /indexes/rag_index/documents?limit=5&offset=0&max_text_length=500\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"limit"}),": (optional) Maximum number of documents to return (default: 10, max: 100)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"offset"}),": (optional) Starting point for the document list (default: 0)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"max_text_length"}),": (optional) Maximum text length to return per document (default: 1000)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"metadata_filter"}),": (optional) A JSON string representing key-value pairs to filter documents by their metadata."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "documents": [\n    {\n      "doc_id": "123456",\n      "text": "Retrieval Augmented Generation (RAG) is an architecture that augments the capabilities of a Large Language Model (LLM) like ChatGPT by adding an information retrieval system that provides grounding data.",\n      "hash_value": "text_hash_value",\n      "metadata": {\n        "author": "Microsoft",\n        "source": "https://learn.microsoft.com/en-us/azure/search/retrieval-augmented-generation-overview?tabs=docs"\n      },\n      "is_truncated": false\n    }\n  ],\n  "count": 1\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Each document in the response includes its unique ",(0,i.jsx)(n.code,{children:"doc_id"}),", the (possibly truncated) text, metadata, and a flag indicating if the text was truncated."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"}),(0,i.jsx)(n.br,{}),"\n","If you want to filter documents by metadata, provide the ",(0,i.jsx)(n.code,{children:"metadata_filter"})," parameter as a JSON string. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'GET /indexes/rag_index/documents?metadata_filter={"author":"Microsoft"}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"updating-documents",children:"Updating Documents"}),"\n",(0,i.jsxs)(n.p,{children:["To update existing documents in a specific index, use the ",(0,i.jsx)(n.code,{children:"/indexes/{index_name}/documents"})," API route. This endpoint accepts a POST request with the index name in the URL and a list of documents to update in the request body."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'POST /indexes/rag_index/documents\n{\n  "documents": [\n    {\n      "doc_id": "123456",\n      "text": "Retrieval Augmented Generation (RAG) is an architecture that augments the capabilities of a Large Language Model (LLM) like ChatGPT by adding an information retrieval system that provides grounding data. Adding an information retrieval system gives you control over grounding data used by an LLM when it formulates a response.",\n      "hash_value": "text_hash_value",\n      "metadata": {\n        "author": "Microsoft",\n        "source": "https://learn.microsoft.com/en-us/azure/search/retrieval-augmented-generation-overview?tabs=docs"\n      },\n    }\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"doc_id"}),": The unique identifier of the document to update."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"text"}),": The new or updated text for the document."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"metadata"}),": (Optional) Updated metadata for the document."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "updated_documents": [\n    {\n      "doc_id": "123456",\n      "text": "Retrieval Augmented Generation (RAG) is an architecture that augments the capabilities of a Large Language Model (LLM) like ChatGPT by adding an information retrieval system that provides grounding data. Adding an information retrieval system gives you control over grounding data used by an LLM when it formulates a response.",\n      "hash_value": "text_hash_value",\n      "metadata": {\n        "author": "Microsoft",\n        "source": "https://learn.microsoft.com/en-us/azure/search/retrieval-augmented-generation-overview?tabs=docs"\n      },\n    }\n  ],\n  "unchanged_documents": [],\n  "not_found_documents": []\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"updated_documents"}),": Documents that were successfully updated."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"unchanged_documents"}),": Documents that were provided but did not require changes."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"not_found_documents"}),": Documents with IDs that were not found in the index."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Use this endpoint to keep your indexed documents up to date with the latest content or metadata."}),"\n",(0,i.jsx)(n.h3,{id:"delete-documents",children:"Delete Documents"}),"\n",(0,i.jsxs)(n.p,{children:["To delete one or more documents from a specific index, use the ",(0,i.jsx)(n.code,{children:"/indexes/{index_name}/documents/delete"})," API route. This endpoint accepts a POST request with the index name in the URL and a list of document IDs to delete in the request body."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'POST /indexes/rag_index/documents/delete\n{\n  "doc_ids": ["123456"]\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"doc_ids"}),": A list of document IDs to delete from the specified index."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "deleted_doc_ids": ["123456"],\n  "not_found_doc_ids": []\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"deleted_doc_ids"}),": Document IDs that were successfully deleted."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"not_found_doc_ids"}),": Document IDs that were not found in the index."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Use this endpoint to remove documents that are no longer needed from your index."}),"\n",(0,i.jsx)(n.h3,{id:"persist-index",children:"Persist Index"}),"\n",(0,i.jsxs)(n.p,{children:["To save (persist) the data of an index to disk, use the ",(0,i.jsx)(n.code,{children:"/persist/{index_name}"})," API route. This endpoint accepts a POST request with the index name in the URL and an optional ",(0,i.jsx)(n.code,{children:"path"})," query parameter specifying where to save the index data."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /persist/rag_index?path=./custom_path\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"index_name"}),": The name of the index to persist."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"}),": (optional) The directory path where the index will be saved. If not provided, the default directory is used."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "message": "Successfully persisted index rag_index to ./custom_path/rag_index."\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Use this endpoint to ensure your indexed data is safely stored on disk."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"load-index",children:"Load Index"}),"\n",(0,i.jsxs)(n.p,{children:["To load an existing index from disk, use the ",(0,i.jsx)(n.code,{children:"/load/{index_name}"})," API route. This endpoint accepts a POST request with the index name in the URL, an optional ",(0,i.jsx)(n.code,{children:"path"})," query parameter specifying where to load the index from, and an optional ",(0,i.jsx)(n.code,{children:"overwrite"})," flag."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /load/rag_index?path=./custom_path/rag_index\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"index_name"}),": The name of the index to load."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"path"}),": (optional) The path to load the index from. If not provided, the default directory is used."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"overwrite"}),": (optional, default: false) If true, will overwrite the existing index if it already exists in memory."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "message": "Successfully loaded index rag_index from ./custom_path/rag_index."\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Use this endpoint to restore previously persisted indexes into memory for querying and updates."}),"\n",(0,i.jsx)(n.h3,{id:"delete-index",children:"Delete Index"}),"\n",(0,i.jsxs)(n.p,{children:["To delete an entire index and all of its documents, use the ",(0,i.jsx)(n.code,{children:"/indexes/{index_name}"})," API route. This endpoint accepts a DELETE request with the index name in the URL. Deleting an index is irreversible and will remove all associated documents from memory."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"DELETE /indexes/rag_index\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"index_name"}),": The name of the index to delete."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "message": "Successfully deleted index rag_index."\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Use this endpoint to permanently remove an index and all its data when it is no longer needed."}),"\n",(0,i.jsx)(n.h3,{id:"query-index",children:"Query Index"}),"\n",(0,i.jsxs)(n.p,{children:["To query a specific index for relevant documents and optionally rerank results with an LLM, use the ",(0,i.jsx)(n.code,{children:"/query"})," API route. This endpoint accepts a POST request with the index name, query string, and optional parameters for result count, LLM generation, and reranking."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'POST /query\n{\n  "index_name": "rag_index",\n  "query": "What is RAG?",\n  "top_k": 5,\n  "llm_params": {\n    "temperature": 0.7,\n    "max_tokens": 2048\n  },\n  "rerank_params": {\n    "top_n": 3\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"index_name"}),": The name of the index to query."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"query"}),": The query string."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"top_k"}),": (optional) Number of top documents to retrieve (default: 5)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"llm_params"}),": (optional) Parameters for LLM-based generation (e.g., temperature, max_tokens)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rerank_params"}),": (optional, experimental) Parameters for reranking results with an LLM."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "response": "Retrieval Augmented Generation (RAG) is an architecture that augments the capabilities of a Large Language Model...",\n  "source_nodes": [\n    {\n      "doc_id": "123456",\n      "node_id": "2853a565-8c1f-4982-acaa-a0ab52691435",\n      "text": "Retrieval Augmented Generation (RAG) is an architecture that augments the capabilities of a Large Language Model...",\n      "score": 0.95,\n      "metadata": {\n        "author": "Microsoft",\n        "source": "https://learn.microsoft.com/en-us/azure/search/retrieval-augmented-generation-overview?tabs=docs"\n      },\n    }\n  ],\n  "metadata": {\n    "2853a565-8c1f-4982-acaa-a0ab52691435": {\n      "author": "Microsoft",\n      "source": "https://learn.microsoft.com/en-us/azure/search/retrieval-augmented-generation-overview?tabs=docs"\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"response"}),": The generated answer or summary from the LLM (if enabled)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"source_nodes"}),": List of source nodes with their text, score, and metadata."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"metadata"}),": Additional metadata about the query or response."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Experimental Warning:"}),(0,i.jsx)(n.br,{}),"\n","The ",(0,i.jsx)(n.code,{children:"rerank_params"})," option is experimental and may cause the query to fail if the LLM reranker produces an invalid response. If reranking fails, the request will return an error."]}),"\n",(0,i.jsx)(n.p,{children:"Use this endpoint to retrieve relevant information from your indexed documents and optionally generate answers using an LLM."}),"\n",(0,i.jsx)(n.h2,{id:"example-client",children:"Example Client"}),"\n",(0,i.jsxs)(n.p,{children:["You can leverage the ",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(7133).A+"",children:"example_rag_client.py"})," as a starting point for a rag client with inputs that match the route documentation above."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},7133:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/example_rag_client-5129c806cb89ed39fece4e5bb63ec907.py"},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>r});var i=t(6540);const s={},a=i.createContext(s);function d(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);